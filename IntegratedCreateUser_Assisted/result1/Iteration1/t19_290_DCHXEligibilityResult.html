/*
 * Licensed Materials - Property of IBM
 *
 * Copyright IBM Corporation 2012-2014. All Rights Reserved.
 *
 * US Government Users Restricted Rights - Use, duplication or disclosure
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 */
dojo.require("dojo.NodeList-traverse");
dojo.require("dojo.fx");
DCHXEligibilityResult={

    // Events
    PROGRAM_ACTION_PREFIX: "program_action_",
    CATEGORY_ACTION_PREFIX: "category_action_",

    currentEnrollment : {},

    showHideDetails:function(node) {

		var titlePane = dojo.query(node).parents(".hcrProgram").first()[0];
		var showDiv = dojo.query(".hcrProgramShowLink", titlePane)[0];
		var hideDiv = dojo.query(".hcrProgramHideLink", titlePane)[0];

		cw.sliding.swap(showDiv, hideDiv);

		dojo.forEach(
		    dojo.query(".hcrProgramDetails", titlePane),
		    cw.sliding.slidePanel);
	},

	programMenuAction: function(programID, action, url) {
	    var eventType = EligibilityResult.PROGRAM_ACTION_PREFIX + action;
	    cw.event.dispatchEvent(eventType, {programID:programID, url:url});
	},

	categoryMenuAction: function(categoryID, action, url, title) {
	    var eventType = EligibilityResult.CATEGORY_ACTION_PREFIX + action;
	    cw.event.dispatchEvent(eventType, {categoryID:categoryID, url:url, title:title});
	},

	selectMembersAction: function(programID) {
	    var eventType = "select_members";
	    cw.event.dispatchEvent(eventType, {programID:programID});
	},


	redirectToEnrollApp: function() {
		window.parent.location.href="https://webpp.dchealthlink.com/fed/idp/initiatesso?providerid=https://enroll-preprod.dchbx.org/saml&returnurl=https://enroll-preprod.dchbx.org/insured/consumer_role/search";
	},
	updateDefaultProgramAction: function(programID) {
	    var eventType = "update_default_program_action";
	    cw.event.dispatchEvent(eventType, {programID:programID});
	},

	updateMyItemsSizeAction: function() {
	    var eventType = "update_my_items_size";
	    cw.event.dispatchEvent(eventType);
	},

	cancelEnrollmentAction: function(programID, enrollmentID, members, reenrolling) {

	    var eventType = "cancel_plan_enrollment";
      cw.event.dispatchEvent(eventType, {
        programID:programID,
        enrollmentID:enrollmentID,
        members:members,
        reenrolling:reenrolling
      });
	},

	selectPrimaryContactAction: function(motivationID, members, programID) {
	    var eventType = "select_primary_contact";
	    cw.event.dispatchEvent(eventType, {motivationID:motivationID,
	    members:members, programID:programID});
	},

	resumeSelectedEnrollmentAction: function(programID) {
	    var eventType = "resume_selected_enrollment";
	    cw.event.dispatchEvent(eventType, {programID:programID});
	},

	updateEntitlementAction: function(motivationID, programID) {
	    var eventType = "update_entitlement";
	    cw.event.dispatchEvent(eventType, {
	        motivationID:motivationID,
	        programID:programID
        });
	}

}

function doNothing() {
	var top = curam.util.getTopmostWindow() || parent || window;
	top.EligibilityResultConnecture.returnAndSaveEnrollment();
}

function cancelEnrollment() {
	var top = curam.util.getTopmostWindow() || parent || window;
	top.EligibilityResultConnecture.returnAndCancelEnrollment();
}

function resumeEnrollment() {
	var top = curam.util.getTopmostWindow() || parent || window;
	top.EligibilityResultConnecture.resumeEnrollment();
}

function exitEnrollment() {
	var top = curam.util.getTopmostWindow() || parent || window;
	top.EligibilityResultConnecture.exitEnrollment();
}

function browsePlans(motivationID, programID) {
	var top = curam.util.getTopmostWindow() || parent || window;
	top.EligibilityResultConnecture.browsePlans(motivationID, programID);
}

function getMotivationID() {
    var motivationID = '';
    var top = curam.util.getTopmostWindow() || parent || window;
    var input = top.dojo.byId('motivationID') || dojo.byId('motivationID');
    if (input) {
        motivationID = input.value;
    } else {
        var ctxPaneId = 'cw-eligibility-results-context-bar';
        var contentPane = top.dijit.byId(ctxPaneId) || dijit.byId(ctxPaneId);
        if (contentPane) {
            motivationID = curam.util.getUrlParamValue(contentPane.href, 'motivationID');
        }
    }
    return motivationID;
}

/**
 * Non logged in users can be returned to the landing page.
 */
function seeIfIQualify() {

	top.CuramExternalApp._loadLandingPage();

}

