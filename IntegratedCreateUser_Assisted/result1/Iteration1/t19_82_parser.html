//>>built
define("dojo/parser",["./_base/kernel","./_base/lang","./_base/array","./_base/config","./_base/html","./_base/window","./_base/url","./_base/json","./aspect","./date/stamp","./has","./query","./on","./ready"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){
new Date("X");
if(1){
var _f=document.createElement("form");
_b.add("dom-attributes-explicit",_f.attributes.length==0);
_b.add("dom-attributes-specified-flag",_f.attributes.length<40);
}
_1.parser=new function(){
var _10={};
function _11(_12){
var map={};
for(var _13 in _12){
if(_13.charAt(0)=="_"){
continue;
}
map[_13.toLowerCase()]=_13;
}
return map;
};
_9.after(_2,"extend",function(){
_10={};
},true);
var _14={};
function _15(_16){
var map=_14[_16]||(_14[_16]={});
return map["__type"]||(map["__type"]=(_2.getObject(_16)||require(_16)));
};
this._functionFromScript=function(_17,_18){
var _19="";
var _1a="";
var _1b=(_17.getAttribute(_18+"args")||_17.getAttribute("args"));
if(_1b){
_3.forEach(_1b.split(/\s*,\s*/),function(_1c,idx){
_19+="var "+_1c+" = arguments["+idx+"]; ";
});
}
var _1d=_17.getAttribute("with");
if(_1d&&_1d.length){
_3.forEach(_1d.split(/\s*,\s*/),function(_1e){
_19+="with("+_1e+"){";
_1a+="}";
});
}
return new Function(_19+_17.innerHTML+_1a);
};
this.instantiate=function(_1f,_20,_21){
_20=_20||{};
_21=_21||{};
var _22=(_21.scope||_1._scopeName)+"Type",_23="data-"+(_21.scope||_1._scopeName)+"-",_24=_23+"type";
var _25=[];
_3.forEach(_1f,function(_26){
var _27=_22 in _20?_20[_22]:_26.getAttribute(_24)||_26.getAttribute(_22);
if(_27){
_25.push({node:_26,"type":_27});
}
});
return this._instantiate(_25,_20,_21);
};
this._instantiate=function(_28,_29,_2a){
var _2b=[];
var _2c=(_2a.scope||_1._scopeName)+"Type",_2d="data-"+(_2a.scope||_1._scopeName)+"-",_2e=_2d+"type",_2f=_2d+"props",_30=_2d+"attach-point",_31=_2d+"attach-event",_32=_2d+"id",_33=_2d+"mixins";
var _34={};
_3.forEach([_2f,_2e,_2c,_32,"jsId",_30,_31,"dojoAttachPoint","dojoAttachEvent","class","style",_33],function(_35){
_34[_35.toLowerCase()]=_35.replace(_2a.scope,"dojo");
});
function _36(_37,_38){
return _37.createSubclass&&_37.createSubclass(_38)||_37.extend.apply(_37,_38);
};
_3.forEach(_28,function(obj){
if(!obj){
return;
}
var _39=obj.node,_3a=obj.type,_3b=_39.getAttribute(_33),_3c;
if(_3b){
var map=_14[_3a];
_3b=_3b.replace(/ /g,"");
_3c=map&&map[_3b];
if(!_3c){
_3c=_15(_3a);
_3c=_14[_3a][_3b]=_36(_3c,_3.map(_3b.split(","),_15));
}
}else{
_3c=_15(_3a);
}
var _3d=_3c&&_3c.prototype;
var _3e={};
if(_2a.defaults){
_2.mixin(_3e,_2a.defaults);
}
if(obj.inherited){
_2.mixin(_3e,obj.inherited);
}
var _3f;
if(_b("dom-attributes-explicit")){
_3f=_39.attributes;
}else{
if(_b("dom-attributes-specified-flag")){
_3f=_3.filter(_39.attributes,function(a){
return a.specified;
});
}else{
var _40=/^input$|^img$/i.test(_39.nodeName)?_39:_39.cloneNode(false),_41=_40.outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,"");
_3f=_3.map(_41.split(/\s+/),function(_42){
var _43=_42.toLowerCase();
return {name:_42,value:(_39.nodeName=="LI"&&_42=="value")||_43=="enctype"?_39.getAttribute(_43):_39.getAttributeNode(_43).value};
});
}
}
var i=0,_44;
while(_44=_3f[i++]){
var _45=_44.name,_46=_45.toLowerCase(),_47=_44.value;
if(_46 in _34){
switch(_34[_46]){
case "data-dojo-props":
var _48=_47;
break;
case "data-dojo-id":
case "jsId":
var _49=_47;
break;
case "data-dojo-attach-point":
case "dojoAttachPoint":
_3e.dojoAttachPoint=_47;
break;
case "data-dojo-attach-event":
case "dojoAttachEvent":
_3e.dojoAttachEvent=_47;
break;
case "class":
_3e["class"]=_39.className;
break;
case "style":
_3e["style"]=_39.style&&_39.style.cssText;
break;
}
}else{
if(!(_45 in _3d)){
var map=(_10[_3a]||(_10[_3a]=_11(_3d)));
_45=map[_46]||_45;
}
if(_45 in _3d){
switch(typeof _3d[_45]){
case "string":
_3e[_45]=_47;
break;
case "number":
_3e[_45]=_47.length?Number(_47):NaN;
break;
case "boolean":
_3e[_45]=_47.toLowerCase()!="false";
break;
case "function":
if(_47===""||_47.search(/[^\w\.]+/i)!=-1){
_3e[_45]=new Function(_47);
}else{
_3e[_45]=_2.getObject(_47,false)||new Function(_47);
}
break;
default:
var _4a=_3d[_45];
_3e[_45]=(_4a&&"length" in _4a)?(_47?_47.split(/\s*,\s*/):[]):(_4a instanceof Date)?(_47==""?new Date(""):_47=="now"?new Date():_a.fromISOString(_47)):(_4a instanceof _1._Url)?(_1.baseUrl+_47):_8.fromJson(_47);
}
}else{
_3e[_45]=_47;
}
}
}
if(_48){
try{
_48=_8.fromJson.call(_2a.propsThis,"{"+_48+"}");
_2.mixin(_3e,_48);
}
catch(e){
throw new Error(e.toString()+" in data-dojo-props='"+_48+"'");
}
}
_2.mixin(_3e,_29);
var _4b=obj.scripts||(_3c&&(_3c._noScript||_3d._noScript)?[]:_c("> script[type^='dojo/']",_39));
var _4c=[],_4d=[],_4e=[],on=[];
if(_4b){
for(i=0;i<_4b.length;i++){
var _4f=_4b[i];
_39.removeChild(_4f);
var _50=(_4f.getAttribute(_2d+"event")||_4f.getAttribute("event")),_51=_4f.getAttribute(_2d+"prop"),_52=_4f.getAttribute("type"),nf=this._functionFromScript(_4f,_2d);
if(_50){
if(_52=="dojo/connect"){
_4c.push({event:_50,func:nf});
}else{
if(_52=="dojo/on"){
on.push({event:_50,func:nf});
}else{
_3e[_50]=nf;
}
}
}else{
if(_52=="dojo/watch"){
_4e.push({prop:_51,func:nf});
}else{
_4d.push(nf);
}
}
}
}
var _53=_3c.markupFactory||_3d.markupFactory;
var _54=_53?_53(_3e,_39,_3c):new _3c(_3e,_39);
_2b.push(_54);
if(_49){
_2.setObject(_49,_54);
}
for(i=0;i<_4c.length;i++){
_9.after(_54,_4c[i].event,_1.hitch(_54,_4c[i].func),true);
}
for(i=0;i<_4d.length;i++){
_4d[i].call(_54);
}
for(i=0;i<_4e.length;i++){
_54.watch(_4e[i].prop,_4e[i].func);
}
for(i=0;i<on.length;i++){
_d(_54,on[i].event,on[i].func);
}
},this);
if(!_29._started){
_3.forEach(_2b,function(_55){
if(!_2a.noStart&&_55&&_2.isFunction(_55.startup)&&!_55._started){
_55.startup();
}
});
}
return _2b;
};
this.scan=function(_56,_57){
var _58=[];
var _59=(_57.scope||_1._scopeName)+"Type",_5a="data-"+(_57.scope||_1._scopeName)+"-",_5b=_5a+"type",_5c=_5a+"textdir";
var _5d=_56.firstChild;
var _5e=_57.inherited;
if(!_5e){
function _5f(_60,_61){
return (_60.getAttribute&&_60.getAttribute(_61))||(_60!==_6.doc&&_60!==_6.doc.documentElement&&_60.parentNode?_5f(_60.parentNode,_61):null);
};
_5e={dir:_5f(_56,"dir"),lang:_5f(_56,"lang"),textDir:_5f(_56,_5c)};
for(var key in _5e){
if(!_5e[key]){
delete _5e[key];
}
}
}
var _62={inherited:_5e};
var _63;
var _64;
function _65(_66){
if(!_66.inherited){
_66.inherited={};
var _67=_66.node,_68=_65(_66.parent);
var _69={dir:_67.getAttribute("dir")||_68.dir,lang:_67.getAttribute("lang")||_68.lang,textDir:_67.getAttribute(_5c)||_68.textDir};
for(var key in _69){
if(_69[key]){
_66.inherited[key]=_69[key];
}
}
}
return _66.inherited;
};
while(true){
if(!_5d){
if(!_62||!_62.node){
break;
}
_5d=_62.node.nextSibling;
_63=_62.scripts;
_64=false;
_62=_62.parent;
continue;
}
if(_5d.nodeType!=1){
_5d=_5d.nextSibling;
continue;
}
if(_63&&_5d.nodeName.toLowerCase()=="script"){
_6a=_5d.getAttribute("type");
if(_6a&&/^dojo\/\w/i.test(_6a)){
_63.push(_5d);
}
_5d=_5d.nextSibling;
continue;
}
if(_64){
_5d=_5d.nextSibling;
continue;
}
var _6a=_5d.getAttribute(_5b)||_5d.getAttribute(_59);
var _6b=_5d.firstChild;
if(!_6a&&(!_6b||(_6b.nodeType==3&&!_6b.nextSibling))){
_5d=_5d.nextSibling;
continue;
}
var _6c={node:_5d,scripts:_63,parent:_62};
var _6d;
try{
_6d=_6a&&_15(_6a);
}
catch(e){
}
var _6e=_6d&&!_6d.prototype._noScript?[]:null;
if(_6a){
_58.push({"type":_6a,node:_5d,scripts:_6e,inherited:_65(_6c)});
}
_5d=_6b;
_63=_6e;
_64=_6d&&_6d.prototype.stopParser&&!(_57.template);
_62=_6c;
}
return _58;
};
this.parse=function(_6f,_70){
var _71;
if(!_70&&_6f&&_6f.rootNode){
_70=_6f;
_71=_70.rootNode;
}else{
if(_6f&&_2.isObject(_6f)&&!("nodeType" in _6f)){
_70=_6f;
}else{
_71=_6f;
}
}
_71=_71?_5.byId(_71):_6.body();
_70=_70||{};
var _72=this.scan(_71,_70);
var _73=_70.template?{template:true}:{};
return this._instantiate(_72,_73,_70);
};
}();
if(_4.parseOnLoad){
_e(100,_1.parser,"parse");
}
return _1.parser;
});
