/*
 * Licensed Materials - Property of IBM
 * 
 * Copyright IBM Corporation 2013. All Rights Reserved.
 *
 * US Government Users Restricted Rights - Use, duplication or disclosure 
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 */
hcr.eventHandler.registerAction(ExitEnrollmentAction={

	eventType : 'exit_enrollment',
	
	execute : function(args) {
	
		ExitEnrollmentAction.exitEnrollment(
			args.programID,
		    args.members, 
		    args.url, 
		    args.enrollmentID, 
		    args.reenrolling);
		
	},
	
	exitEnrollment: function(programID, members, url, enrollmentID, reenrolling) {
	
		var motivationID = getMotivationID();
		var exitUrl = cw.fragment.constructURL('HealthCare_actionExitPlanEnrollment');
		var exitParams = {
		    motivationID:motivationID, 
		    members:members, 
		    programID:programID,
	        enrollmentID:enrollmentID, 
	        reenrolling:reenrolling
		};
		cw.ajax.call(exitUrl, exitParams,
	        ExitEnrollmentAction.exitPlanEnrollmentCallback);
	},
	
	exitPlanEnrollmentCallback: function(message, call) {
	
		var motivationID = getMotivationID();
		var programID = EligibilityResult.currentEnrollment.programID;
	
		cw.fragment.load(
			'background-panel', 
			'CitizenWorkspace_eligibilityResultsUpdateAndReturn', 
			{motivationID:motivationID, programID:programID});
	}

});

