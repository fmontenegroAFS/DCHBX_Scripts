/*
 * Licensed Materials - Property of IBM
 * 
 * Copyright IBM Corporation 2014. All Rights Reserved.
 *
 * US Government Users Restricted Rights - Use, duplication or disclosure 
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 */
 
hcr.eventHandler.registerAction(ResumeSelectedEnrollmentAction={

	eventType : 'resume_selected_enrollment',
	
	execute : function(args) {
	
		ResumeSelectedEnrollmentAction.resumeSelectedEnrollment(args.programID);
		
	},
	
	resumeSelectedEnrollment: function(programID) {
	
	    var enrollments = [];
	    var members = [];
	    hcr.blockAndShowErrorMessage = false;
	    
	    dojo.query('input:checked', 'list-inprogress-enrollment-table').forEach(
	        function(checkbox) {
                enrollments.push(checkbox.value);
	        }
	    );

	    
			if (enrollments.length == 0) {
			
				hcr.blockAndShowErrorMessage = true;
				ResumeSelectedEnrollmentAction.createErrorMessage("At least one enrollment must be selected to proceed");
				
			} else if (enrollments.length > 1) {
			
				hcr.blockAndShowErrorMessage = true;
				ResumeSelectedEnrollmentAction.createErrorMessage("Only one enrollment must be selected");
				    
	    } else {
	    
	    	var checkBoxID = "checkbox" + enrollments;
	    	var members = dojo.attr(dojo.byId(checkBoxID), "members");
	    	var reenrolling = "true";
				var enrollmentID = enrollments[0];
	    	
//	    	cw.event.dispatchEvent('open_connecture', {
//	    	    enrollmentID:enrollmentID, 
//	    	    programID:programID, 
//	    	    members:members, 
//	    	    reenrolling: reenrolling
//    	    });
	    cw.event.dispatchEvent('resume_enrollment', {programID:programID, enrollmentID:enrollmentID});

	    }  
	},
	
				
	createErrorMessage: function(msg) {
		dojo.query('#error-messages-container').forEach(dojo.destroy);
		
		var contentPane = dojo.byId("list-inprogress-enrollment-page");
				
		var hcrErrorMessages = dojo.create("div", 
				{id: "error-messages-container"}, contentPane, "first");
      
    dojo.query('#error-messages-container').forEach(function(node) { node.innerHTML = 
      "<div><img src=\"./Images/error_icon.png\">"+msg+"</div>"; });
      
	}

});

